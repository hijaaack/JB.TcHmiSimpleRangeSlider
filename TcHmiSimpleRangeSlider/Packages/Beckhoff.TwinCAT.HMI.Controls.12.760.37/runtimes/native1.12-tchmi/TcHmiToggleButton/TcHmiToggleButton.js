var TcHmi;!function(TcHmi){!function(Controls){!function(Beckhoff){class TcHmiToggleButton extends Beckhoff.TcHmiButton{constructor(element,pcElement,attrs){super(element,pcElement,attrs),this.__restoreUserInputOnLoad=!1,this.__dataPrecedence=TcHmi.DataPrecedence.Data,this.__userInput=null,this.__toggleLock=!1,this.__touchLockTimeoutId=0,this.__onToggleGroupToggledEventDestroyEvent=null}__previnit(){super.__previnit()}__init(){super.__init(),this.__storage=new TcHmi.LocalStorage(this,{})}__attach(){if(super.__attach(),this.__restoreUserInputOnLoad){const userInput=this.__storage?.get("userInput");userInput&&(this.__userInput=userInput,this.__evaluateDataPrecedence(this.__state)||this.__writeState(this.__userInput.userData,"userInteraction"))}}__detach(){super.__detach()}destroy(){this.__keepAlive||(null!==this.__onToggleGroupToggledEventDestroyEvent&&(this.__onToggleGroupToggledEventDestroyEvent(),this.__onToggleGroupToggledEventDestroyEvent=null),super.destroy())}__setInternalState(state,source){("userInteraction"===source||"toggleGroup"===source||this.__evaluateDataPrecedence(state))&&this.__state!==state&&(this.__setToggleState(state?"Active":"Normal",!0,!1),state&&null!==this.__toggleGroup&&TcHmi.EventProvider.raise(this.__toggleGroup+".toggled",{ActiveElementId:this.__id,source:source}),super.__setInternalState(state,source))}__onPropertyIsEnabledChanged(){return(e,data)=>{data&&(this.getIsEnabled()?!this.__destroyStateSymbolWatch&&this.__stateSymbol&&(this.__destroyStateSymbolWatch=this.__stateSymbol.watch(this.__onStateSymbolWatch())):(this.__mousedown=!1,this.__stateLock=!1,this.__touches=[],this.__destroyStateSymbolWatch&&(this.__destroyStateSymbolWatch(),this.__destroyStateSymbolWatch=null)))}}__onMouseDown(){return event=>{this.__touchLock||0===event.button&&this.getIsEnabled()&&TcHmi.Access.checkAccess(this,"operate")&&(this.__mousedown=!0,!1===this.__stateLock&&(!1===this.__state?(this.__toggleLock=!0,this.__stateLock=!0):this.__toggleLock=!1,this.__destroyStateSymbolWatch&&(this.__destroyStateSymbolWatch(),this.__destroyStateSymbolWatch=null),this.__userInput?this.__userInput.userData=!this.__state:this.__userInput={userData:!this.__state,originalData:this.__state},this.__restoreUserInputOnLoad&&this.__storage?.set("userInput",this.__userInput),this.__writeState(!0,"userInteraction")))}}__onMouseUp(){return event=>{this.__touchLock||0===event.button&&this.__mousedown&&this.getIsEnabled()&&TcHmi.Access.checkAccess(this,"operate")&&(this.__mousedown=!1,!1===this.__toggleLock&&(this.__userInput?this.__userInput.userData=!1:this.__userInput={userData:!1,originalData:this.__state},this.__restoreUserInputOnLoad&&this.__storage?.set("userInput",this.__userInput),this.__writeState(!1,"userInteraction")),this.__stateLock=!1,!this.__destroyStateSymbolWatch&&this.__stateSymbol&&(this.__destroyStateSymbolWatch=this.__stateSymbol.watch(this.__onStateSymbolWatch())))}}__onMouseEnter(){return event=>{}}__onMouseLeave(){return event=>{this.__mousedown&&(1!==event.buttons&&(this.__mousedown=!1),this.getIsEnabled()&&TcHmi.Access.checkAccess(this,"operate")&&(this.__mousedown=!1,!1===this.__toggleLock&&(this.__userInput?this.__userInput.userData=!1:this.__userInput={userData:!1,originalData:this.__state},this.__restoreUserInputOnLoad&&this.__storage?.set("userInput",this.__userInput),this.__writeState(!1,"userInteraction")),this.__stateLock=!1,!this.__destroyStateSymbolWatch&&this.__stateSymbol&&(this.__destroyStateSymbolWatch=this.__stateSymbol.watch(this.__onStateSymbolWatch()))))}}__onTouchStart(){return event=>{if(!this.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this,"operate"))return;let changedTouches=Array.prototype.slice.apply(event.changedTouches).filter((touch=>touch.target===event.target));0!==changedTouches.length&&(this.__touches=this.__touches.concat(changedTouches.map((touch=>touch))),!1===this.__stateLock&&(!1===this.__state?(this.__toggleLock=!0,this.__stateLock=!0):this.__toggleLock=!1,this.__destroyStateSymbolWatch&&(this.__destroyStateSymbolWatch(),this.__destroyStateSymbolWatch=null),this.__userInput?this.__userInput.userData=!this.__state:this.__userInput={userData:!this.__state,originalData:this.__state},this.__restoreUserInputOnLoad&&this.__storage?.set("userInput",this.__userInput),this.__writeState(!0,"userInteraction")),this.__touchLockTimeoutId&&(clearTimeout(this.__touchLockTimeoutId),this.__touchLockTimeoutId=0),this.__touchLock=!0)}}__onTouchEndOrCancel(){return event=>{if(0===this.__touches.length)return;if(!this.getIsEnabled())return;if(!TcHmi.Access.checkAccess(this,"operate"))return;const activeTouchIds=Array.from(event.touches).map((touch=>touch.identifier));this.__touches=this.__touches.filter((touch=>activeTouchIds.includes(touch.identifier))),0===this.__touches.length&&(!1===this.__toggleLock&&(this.__userInput?this.__userInput.userData=!1:this.__userInput={userData:!1,originalData:this.__state},this.__restoreUserInputOnLoad&&this.__storage?.set("userInput",this.__userInput),this.__writeState(!1,"userInteraction")),this.__stateLock=!1,!this.__destroyStateSymbolWatch&&this.__stateSymbol&&(this.__destroyStateSymbolWatch=this.__stateSymbol.watch(this.__onStateSymbolWatch()))),this.__touchLockTimeoutId&&(clearTimeout(this.__touchLockTimeoutId),this.__touchLockTimeoutId=0),this.__touchLockTimeoutId=setTimeout((()=>{this.__touchLock=!1}),500)}}__onToggleGroupToggled(){return(evt,data)=>{if(data&&data.ActiveElementId&&data.ActiveElementId!==this.__id&&(!this.__stateSymbol||this.__stateSymbol.getExpression().toString()!==data.source)){if("userInteraction"===data.source)this.__state&&(this.__userInput?this.__userInput.userData=!1:this.__userInput={userData:!1,originalData:this.__state},this.__restoreUserInputOnLoad&&this.__storage?.set("userInput",this.__userInput));else if(!this.__evaluateDataPrecedence(!1))return;this.__writeState(!1,"toggleGroup")}}}setToggleGroup(valueNew){let convertedValue=TcHmi.ValueConverter.toString(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("ToggleGroup")),convertedValue!==this.__toggleGroup&&(this.__toggleGroup=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ToggleGroup"}),this.__processToggleGroup())}getToggleGroup(){return this.__toggleGroup}__processToggleGroup(){null!==this.__onToggleGroupToggledEventDestroyEvent&&(this.__onToggleGroupToggledEventDestroyEvent(),this.__onToggleGroupToggledEventDestroyEvent=null),null!==this.__toggleGroup&&(this.__onToggleGroupToggledEventDestroyEvent=TcHmi.EventProvider.register(this.__toggleGroup+".toggled",this.__onToggleGroupToggled()))}__setToggleState(valueNew,forwardStateSymbol=!0,process=!1){let convertedValue=TcHmi.ValueConverter.toToggleState(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("ToggleState")),convertedValue!==this.__toggleState&&(this.__toggleState=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ToggleState"}),TcHmi.EventProvider.raise(this.__id+".onToggleStateChanged"),process&&this.__processToggleState())}setToggleState(valueNew){this.__evaluateDataPrecedence("Active"===valueNew)&&this.__setToggleState(valueNew,!0,!0)}getToggleState(){return this.__toggleState}__processToggleState(forwardStateSymbol=!0){this.__writeState("Active"===this.__toggleState,"attribute")}setRestoreUserInputOnLoad(valueNew){let convertedValue=TcHmi.ValueConverter.toBoolean(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("RestoreUserInputOnLoad")),convertedValue!==this.__restoreUserInputOnLoad&&(this.__restoreUserInputOnLoad=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"RestoreUserInputOnLoad"}),this.__processRestoreUserInputOnLoad())}getRestoreUserInputOnLoad(){return this.__restoreUserInputOnLoad}__processRestoreUserInputOnLoad(){this.__restoreUserInputOnLoad?this.__userInput&&this.__storage?.set("userInput",this.__userInput):this.__storage?.delete("userInput")}resetUserInput(restoreOriginalValue){this.__userInput&&(restoreOriginalValue&&this.__writeState(this.__userInput.originalData,"userInteraction"),this.__userInput=null,this.__storage?.delete("userInput"))}setDataPrecedence(valueNew){let convertedValue=TcHmi.ValueConverter.toEnum(valueNew,TcHmi.DataPrecedence);null===convertedValue&&(convertedValue=TcHmi.ValueConverter.toEnum(this.getAttributeDefaultValueInternal("DataPrecedence"),TcHmi.DataPrecedence,TcHmi.DataPrecedence.Data)),convertedValue!==this.__dataPrecedence&&(this.__dataPrecedence=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"DataPrecedence"}))}getDataPrecedence(){return this.__dataPrecedence}__evaluateDataPrecedence(incoming){if(!this.__userInput||void 0===this.__dataPrecedence)return!0;switch(this.__dataPrecedence){case TcHmi.DataPrecedence.Data:return this.__userInput=null,this.__storage?.delete("userInput"),!0;case TcHmi.DataPrecedence.UserInput:return this.__userInput.originalData!==incoming&&(this.__userInput.originalData=incoming,this.__storage?.set("userInput",this.__userInput)),!1;case TcHmi.DataPrecedence.ChangedDataOnly:return this.__userInput.originalData!==incoming&&(this.__userInput=null,this.__storage?.delete("userInput"),!0)}}}Beckhoff.TcHmiToggleButton=TcHmiToggleButton}(Controls.Beckhoff||(Controls.Beckhoff={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),TcHmi.Controls.registerEx("TcHmiToggleButton","TcHmi.Controls.Beckhoff",TcHmi.Controls.Beckhoff.TcHmiToggleButton);