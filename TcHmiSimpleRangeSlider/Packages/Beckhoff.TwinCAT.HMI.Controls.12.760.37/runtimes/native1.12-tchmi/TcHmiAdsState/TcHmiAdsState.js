var TcHmi,__classPrivateFieldGet=this&&this.__classPrivateFieldGet||function(receiver,state,kind,f){if("a"===kind&&!f)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof state?receiver!==state||!f:!state.has(receiver))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===kind?f:"a"===kind?f.call(receiver):f?f.value:state.get(receiver)};!function(TcHmi){!function(Controls){!function(Beckhoff){var _a,_TcHmiAdsState_tchmiFQN;class TcHmiAdsState extends TcHmi.Controls.System.TcHmiControl{constructor(element,pcElement,attrs){super(element,pcElement,attrs),this.__subscriptionId=null,this.__localizedElements=new Map,this.__localizationReader=void 0,this.__destroyLocalizationWatch=null,this.__onResolverForStateImagesWatchCallback=data=>{!1===this.__isAttached&&this.__suspendObjectResolver("stateImages"),data.error===TcHmi.Errors.NONE?tchmi_equal(data.value,this.__stateImages)||(this.__stateImages=data.value,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"StateImages"}),this.__processStateImages()):TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx("[Source=Control, Module="+this.__type+(__classPrivateFieldGet(TcHmiAdsState,_a,"f",_TcHmiAdsState_tchmiFQN)!==this.__type?", Origin="+__classPrivateFieldGet(TcHmiAdsState,_a,"f",_TcHmiAdsState_tchmiFQN):"")+", Id="+this.getId()+", Attribute=StateImages] Resolving symbols from object failed with error: "+TcHmi.Log.buildMessage(data.details))}}__previnit(){if(super.__previnit(),this.__elementTemplateRoot=this.__element[0].getElementsByClassName("TcHmi_Controls_Beckhoff_TcHmiAdsState-template")[0],!this.__elementTemplateRoot)throw new Error("Invalid Template.html");this.__destroyLocalizationWatch=this.__localization.watch((data=>{if(data.error===TcHmi.Errors.NONE&&data.reader&&(this.__localizationReader=data.reader,!this.__tooltip))for(const[element,info]of this.__localizedElements){let localizedText=data.reader.get(info.key);info.parameters&&(localizedText=tchmi_format_string(localizedText,...info.parameters)),element.setAttribute("title",tchmi_decode_control_characters(localizedText))}}))}__init(){super.__init()}__attach(){super.__attach(),this.__updateSubscription()}__detach(){super.__detach(),null!==this.__subscriptionId&&TcHmi.Server.unsubscribeEx(this.__subscriptionId,null,(data=>{data.error!==TcHmi.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type+(__classPrivateFieldGet(TcHmiAdsState,_a,"f",_TcHmiAdsState_tchmiFQN)!==this.__type?", Origin="+__classPrivateFieldGet(TcHmiAdsState,_a,"f",_TcHmiAdsState_tchmiFQN):"")}, Id=${this.getId()}, Symbol=`+this.__serverDomain+".AdsSyncReadStateReq] "+TcHmi.Log.buildMessage(data.details))}))}destroy(){this.__keepAlive||(super.destroy(),this.__destroyLocalizationWatch?.(),this.__destroyLocalizationWatch=null)}__updateSubscription(){!TCHMI_DESIGNER&&this.__isAttached&&(null!==this.__subscriptionId&&TcHmi.Server.unsubscribeEx(this.__subscriptionId,null,(data=>{data.error!==TcHmi.Errors.NONE&&TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type+(__classPrivateFieldGet(TcHmiAdsState,_a,"f",_TcHmiAdsState_tchmiFQN)!==this.__type?", Origin="+__classPrivateFieldGet(TcHmiAdsState,_a,"f",_TcHmiAdsState_tchmiFQN):"")}, Id=${this.getId()}, Symbol=`+this.__serverDomain+".AdsSyncReadStateReq] "+TcHmi.Log.buildMessage(data.details))})),this.__subscriptionId=TcHmi.Server.subscribeEx([{commandOptions:["SendErrorMessage"],symbol:this.__serverDomain+".AdsSyncReadStateReq",writeValue:this.__adsRuntime}],this.__serverInterval??TcHmi.Config.get().tcHmiServer.websocketIntervalTime??500,null,this.__serverResponseHandler()))}__serverResponseHandler(){return data=>{if(this.__removeLocalizedElement(this.__elementTemplateRoot),data.error!==TcHmi.Errors.NONE)return TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type+(__classPrivateFieldGet(TcHmiAdsState,_a,"f",_TcHmiAdsState_tchmiFQN)!==this.__type?", Origin="+__classPrivateFieldGet(TcHmiAdsState,_a,"f",_TcHmiAdsState_tchmiFQN):"")}, Id=${this.getId()}, Symbol=`+this.__serverDomain+".AdsSyncReadStateReq] "+TcHmi.Log.buildMessage(data.details)),data.details?.message?this.__addLocalizedElement(this.__element[0],"ErrorPlaceholder",data.details.message):this.__addLocalizedElement(this.__element[0],"SubscriptionFailed",this.__serverDomain),void this.__elementTemplateRoot.setAttribute("data-tchmi-runtime-state","ConnectionError");if(!data.response)return TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type+(__classPrivateFieldGet(TcHmiAdsState,_a,"f",_TcHmiAdsState_tchmiFQN)!==this.__type?", Origin="+__classPrivateFieldGet(TcHmiAdsState,_a,"f",_TcHmiAdsState_tchmiFQN):"")}, Id=${this.getId()},Symbol=`+this.__serverDomain+".AdsSyncReadStateReq] "+TcHmi.Log.buildMessage({code:TcHmi.Errors.E_SERVER_RESPONSE_MISSING,message:TcHmi.Errors[TcHmi.Errors.E_SERVER_RESPONSE_MISSING],reason:"Missing response from server.",domain:this.__type})),this.__addLocalizedElement(this.__element[0],"MissingResponse"),void this.__elementTemplateRoot.setAttribute("data-tchmi-runtime-state","ConnectionError");if(data.response.error)return TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type+(__classPrivateFieldGet(TcHmiAdsState,_a,"f",_TcHmiAdsState_tchmiFQN)!==this.__type?", Origin="+__classPrivateFieldGet(TcHmiAdsState,_a,"f",_TcHmiAdsState_tchmiFQN):"")}, Id=${this.getId()}, Symbol=`+this.__serverDomain+".AdsSyncReadStateReq] "+TcHmi.Log.buildMessage(data.response.error)),data.response.error.message?this.__addLocalizedElement(this.__element[0],"ErrorPlaceholder",data.response.error.message):this.__addLocalizedElement(this.__element[0],"SubscriptionFailed",this.__serverDomain),void this.__elementTemplateRoot.setAttribute("data-tchmi-runtime-state","ConnectionError");if(!data.response.commands||0===data.response.commands.length)return TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type+(__classPrivateFieldGet(TcHmiAdsState,_a,"f",_TcHmiAdsState_tchmiFQN)!==this.__type?", Origin="+__classPrivateFieldGet(TcHmiAdsState,_a,"f",_TcHmiAdsState_tchmiFQN):"")}, Id=${this.getId()}, Symbol=`+this.__serverDomain+".AdsSyncReadStateReq] "+TcHmi.Log.buildMessage({code:TcHmi.Errors.E_SERVER_COMMANDS_MISSING,message:TcHmi.Errors[TcHmi.Errors.E_SERVER_COMMANDS_MISSING],reason:"Missing commands in response from server with id: "+data.response.id,domain:this.__type})),this.__addLocalizedElement(this.__element[0],"MissingCommands",data.response.id),void this.__elementTemplateRoot.setAttribute("data-tchmi-runtime-state","ConnectionError");for(const command of data.response.commands){if(command.error){TCHMI_CONSOLE_LOG_LEVEL>=1&&TcHmi.Log.errorEx(`[Source=Control, Module=${this.__type+(__classPrivateFieldGet(TcHmiAdsState,_a,"f",_TcHmiAdsState_tchmiFQN)!==this.__type?", Origin="+__classPrivateFieldGet(TcHmiAdsState,_a,"f",_TcHmiAdsState_tchmiFQN):"")}, Id=${this.getId()}, Symbol=`+this.__serverDomain+".AdsSyncReadStateReq] "+TcHmi.Log.buildMessage(command.error)),"HMI_ADS_E_INVALID_RUNTIME"===command.error.message?this.__addLocalizedElement(this.__element[0],"InvalidRuntime",this.__adsRuntime):"HMI_ADS_E_STATE"===command.error.message?this.__addLocalizedElement(this.__element[0],"InvalidRouter"):"HMI_ADS_E_INVALID_SYMBOL"===command.error.message?this.__addLocalizedElement(this.__element[0],"InvalidSymbol"):"HMI_ADS_E_INVALID_PARAMETER"===command.error.message?this.__addLocalizedElement(this.__element[0],"InvalidParameter"):"HMI_ADS_E_TCVERSION"===command.error.message?this.__addLocalizedElement(this.__element[0],"InvalidTwinCATVersion"):"HMI_ADS_E_CONFIGDIR"===command.error.message?this.__addLocalizedElement(this.__element[0],"ConfigDirectory"):"HMI_ADS_E_PARSE_BASETYPES"===command.error.message?this.__addLocalizedElement(this.__element[0],"ParseBaseTypes"):"HMI_ADS_E_PARSE_DATA"===command.error.message?this.__addLocalizedElement(this.__element[0],"ParseAdsDate"):"HMI_ADS_E_INVALID_DATA"===command.error.message?this.__addLocalizedElement(this.__element[0],"InvalidData"):"HMI_ADS_E_MISSING_PARAMETER"===command.error.message?this.__addLocalizedElement(this.__element[0],"MissingParameter"):"HMI_ADS_E_DISABLED"===command.error.message?this.__addLocalizedElement(this.__element[0],"RuntimeDisabled",this.__adsRuntime):command.error.message?this.__addLocalizedElement(this.__element[0],"ErrorPlaceholder",command.error.message):this.__addLocalizedElement(this.__element[0],"SubscriptionFailed",this.__serverDomain),this.__elementTemplateRoot.setAttribute("data-tchmi-runtime-state","ConnectionError");let imgUrl="";this.__stateImages?.Error?imgUrl="url("+this.__stateImages.Error+")":this.__stateImages?.Fallback&&(imgUrl="url("+this.__stateImages.Fallback+")"),TcHmi.StyleProvider.setSimpleElementStyle(this.__elementTemplateRoot,"background-image",imgUrl);continue}let adsState=command?.readValue?.AdsState??TcHmiAdsState.AdsState.Error,state=TcHmiAdsState.AdsState[adsState]??"Unknown";this.__addLocalizedElement(this.__element[0],"State",this.__serverDomain,this.__adsRuntime,state),this.__elementTemplateRoot.setAttribute("data-tchmi-runtime-state",state);let imgUrl="";this.__stateImages?.[state]?imgUrl="url("+this.__stateImages[state]+")":this.__stateImages?.Fallback&&(imgUrl="url("+this.__stateImages.Fallback+")"),TcHmi.StyleProvider.setSimpleElementStyle(this.__elementTemplateRoot,"background-image",imgUrl)}}}__addLocalizedElement(element,key,...parameters){let info={key:key};if(0!==parameters.length&&(info.parameters=parameters),this.__localizedElements.set(element,info),!this.__tooltip&&this.__localizationReader){let localizedText=this.__localizationReader.get(key);info.parameters&&(localizedText=tchmi_format_string(localizedText,...info.parameters)),element.setAttribute("title",tchmi_decode_control_characters(localizedText))}}__removeLocalizedElement(element){this.__localizedElements.delete(element)}setAdsRuntime(valueNew){let convertedValue=TcHmi.ValueConverter.toString(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("AdsRuntime")),convertedValue!==this.__adsRuntime&&(this.__adsRuntime=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"AdsRuntime"}),this.__processAdsRuntime())}getAdsRuntime(){return this.__adsRuntime}__processAdsRuntime(){this.__isAttached&&this.__updateSubscription()}setServerInterval(valueNew){let convertedValue=TcHmi.ValueConverter.toNumber(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("ServerInterval")),convertedValue!==this.__serverInterval&&(this.__serverInterval=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ServerInterval"}),this.__processServerInterval())}getServerInterval(){return this.__serverInterval}__processServerInterval(){this.__isAttached&&this.__updateSubscription()}setServerDomain(valueNew){let convertedValue=TcHmi.ValueConverter.toString(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("ServerDomain")),convertedValue!==this.__serverDomain&&(this.__serverDomain=convertedValue,TcHmi.EventProvider.raise(this.__id+".onPropertyChanged",{propertyName:"ServerDomain"}),this.__processServerDomain())}getServerDomain(){return this.__serverDomain}__processServerDomain(){this.__isAttached&&this.__updateSubscription()}setStateImages(valueNew){let convertedValue=TcHmi.ValueConverter.toObject(valueNew);null===convertedValue&&(convertedValue=this.getAttributeDefaultValueInternal("StateImages"));let resolverInfo=this.__objectResolvers.get("stateImages");resolverInfo&&(resolverInfo.watchDestroyer&&resolverInfo.watchDestroyer(),resolverInfo.resolver.destroy());let resolver=new TcHmi.Symbol.ObjectResolver(convertedValue,this);this.__objectResolvers.set("stateImages",{resolver:resolver,watchCallback:this.__onResolverForStateImagesWatchCallback,watchDestroyer:resolver.watch(this.__onResolverForStateImagesWatchCallback)})}getStateImages(){return this.__stateImages}__processStateImages(){this.__isAttached&&this.__updateSubscription()}__processTooltip(){if(super.__processTooltip(),!this.__tooltip&&this.__localizationReader)for(const[element,info]of this.__localizedElements){let localizedText=this.__localizationReader.get(info.key);info.parameters&&(localizedText=tchmi_format_string(localizedText,...info.parameters)),element.setAttribute("title",tchmi_decode_control_characters(localizedText))}}}_TcHmiAdsState_tchmiFQN={value:"TcHmi.Controls.Beckhoff."+(_a=TcHmiAdsState).name},Beckhoff.TcHmiAdsState=TcHmiAdsState,function(TcHmiAdsState){let AdsState;!function(AdsState){AdsState[AdsState.Invalid=0]="Invalid",AdsState[AdsState.Idle=1]="Idle",AdsState[AdsState.Reset=2]="Reset",AdsState[AdsState.Init=3]="Init",AdsState[AdsState.Start=4]="Start",AdsState[AdsState.Run=5]="Run",AdsState[AdsState.Stop=6]="Stop",AdsState[AdsState.SaveCfg=7]="SaveCfg",AdsState[AdsState.LoadCfg=8]="LoadCfg",AdsState[AdsState.PowerFailure=9]="PowerFailure",AdsState[AdsState.PowerGood=10]="PowerGood",AdsState[AdsState.Error=11]="Error",AdsState[AdsState.Shutdown=12]="Shutdown",AdsState[AdsState.Suspend=13]="Suspend",AdsState[AdsState.Resume=14]="Resume",AdsState[AdsState.Config=15]="Config",AdsState[AdsState.Reconfig=16]="Reconfig",AdsState[AdsState.Stopping=17]="Stopping",AdsState[AdsState.Incompatible=18]="Incompatible",AdsState[AdsState.Exception=19]="Exception"}(AdsState=TcHmiAdsState.AdsState||(TcHmiAdsState.AdsState={}))}(TcHmiAdsState=Beckhoff.TcHmiAdsState||(Beckhoff.TcHmiAdsState={}))}(Controls.Beckhoff||(Controls.Beckhoff={}))}(TcHmi.Controls||(TcHmi.Controls={}))}(TcHmi||(TcHmi={})),TcHmi.Controls.registerEx("TcHmiAdsState","TcHmi.Controls.Beckhoff",TcHmi.Controls.Beckhoff.TcHmiAdsState);